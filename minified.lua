platform.apilevel="2.5"local a=true;local b=true;local c=D2Editor.newRichText()local d=D2Editor.newRichText()local e={}local f={}local g={}local h={-1}local i=""local j=0;local k=0;local l=false;toolpalette.register{{"Search Options",{"Auto",function()a=true end},{"Manual",function()a=false end},{"Term Only",function()b=false end},{"Term and Def Search",function()b=true end}},{"Font Sizes",{"9",function()d:setFontSize(9)end},{"12",function()d:setFontSize(12)end},{"16",function()d:setFontSize(16)end},{"24",function()d:setFontSize(24)end}}}local function m()l=false;local n=c:getText()n=n==nil and""or n:match"^%s*(.-)%s*$"g={}for o=1,#e do if n==""or e[o]:lower():find(n:lower())or b and f[o]:lower():find(n:lower())then g[#g+1]=e[o]end end;i=""if next(g)==nil then d:setText(i)return end;i=table.concat(g,"\n")local p=0;for o=1,#g do p=p+g[o]:len()+1;h[o+1]=p-1 end;d:setExpression(i,h[2],h[2])end;function on.resize(q,r)local s=0;j=q;k=r;c:move(j*0.015,k*0.03):resize(j*0.975,k*0.11):setMainFont("sansserif","r",9):setTextChangeListener(function()if a then m()end end):setFocus():registerFilter{enterKey=function()if not a then m()end;d:setFocus()end}d:move(j*0.015,k*0.17):resize(j*0.975,k*0.81):setMainFont("sansserif","r",7):setReadOnly():registerFilter{enterKey=function()if not l and i~=""then _,s=d:getExpressionSelection()for o=1,#h do if s>=h[o]+1 and s<=h[o+1]then local t;for u=1,#e do if e[u]==g[o]then t=u;break end end;d:setExpression(f[t],0,0)l=true;return end end end end,escapeKey=function()if l then d:setExpression(i,s,s)l=false else c:setFocus()end end}m()end;function on.paint(v)v:drawRect(j*0.01,k*0.02,j*0.98,k*0.12)v:drawRect(j*0.01,k*0.165,j*0.98,k*0.82)end
